---

- name: Ensure Java pre packages are installed
  apt:
    pkg: '{{ item }}'
    state: present
  with_items: '{{ java_pre_packages }}'

- name: Install apt keys
  apt_key:
    keyserver: "{{ java_apt_keyserver }}"
    id: "{{ java_apt_keyid }}"
    state: present

- name: Install repositories
  apt_repository:
    repo: '{{ item }}'
    state: present
    update_cache: true
  when: java_repositories is defined and java_repositories|length
  with_items: '{{ java_repositories }}'

- name: Update apt cache
  apt:
    update_cache: yes
    cache_valid_time: 86400

- name: Accept Java 8 License
  debconf:
    name: "oracle-java8-installer"
    question: "shared/accepted-oracle-license-v1-1"
    value: "true"
    vtype: "select"

- name: Ensure Java is installed
  apt:
    pkg: '{{ item }}'
    state: present
  with_items: '{{ java_packages }}'
